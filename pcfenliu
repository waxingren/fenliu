# ä»£ç†ç›‘å¬ç«¯å£
mixed-port: 7890  # ä»£ç†æœåŠ¡ç›‘å¬çš„ç«¯å£ï¼ˆé€šå¸¸æ˜¯ HTTP/HTTPS ä»£ç†ç«¯å£ï¼‰
ipv6: false  # ç¦ç”¨ IPv6
allow-lan: true  # å…è®¸å±€åŸŸç½‘è®¾å¤‡è®¿é—®ä»£ç†æœåŠ¡
unified-delay: false  # ä¸ç»Ÿä¸€å»¶è¿Ÿç­–ç•¥ï¼Œå…è®¸æ¯ä¸ªè¿æ¥æœ‰ä¸åŒçš„å»¶è¿Ÿç­–ç•¥
tcp-concurrent: true  # å…è®¸ TCP å¹¶å‘è¿æ¥
external-controller: 127.0.0.1:9090  # å¤–éƒ¨æ§åˆ¶å™¨çš„åœ°å€å’Œç«¯å£ï¼Œç”¨äºä¸ä»£ç†æœåŠ¡é€šä¿¡ï¼ˆå¦‚ API æ§åˆ¶ï¼‰
external-ui: ui  # ä½¿ç”¨å¤–éƒ¨ UI ç•Œé¢ï¼Œé»˜è®¤ä½ç½®æ˜¯ "ui"
external-ui-url: "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"  # å¤–éƒ¨ UI çš„ä¸‹è½½åœ°å€
keep-alive-interval: 1800  # ä¿æŒè¿æ¥çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºç§’ï¼Œ1800 ç§’ = 30 åˆ†é’Ÿ

# GeoIP è®¾ç½®ï¼Œç”¨äºæŒ‰åœ°ç†ä½ç½®é€‰æ‹©ä»£ç†èŠ‚ç‚¹
geodata-mode: true  # å¯ç”¨åœ°ç†æ•°æ®æ¨¡å¼
geodata-loader: standard  # ä½¿ç”¨æ ‡å‡†çš„åœ°ç†æ•°æ®åŠ è½½å™¨
geo-auto-update: false  # ç¦æ­¢è‡ªåŠ¨æ›´æ–°åœ°ç†æ•°æ®
geo-update-interval: 24  # æ¯ 24 å°æ—¶æ›´æ–°ä¸€æ¬¡åœ°ç†æ•°æ®
geox-url:
  geoip: "https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat"  # GeoIP æ•°æ®æº URL
  geosite: "https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"  # GeoSite æ•°æ®æº URL
  mmdb: "https://cdn.jsdelivr.net/gh/soffchen/GeoIP2-CN@release/Country.mmdb"  # GeoIP2 å›½å®¶æ•°æ® URL
  asn: "https://mirror.ghproxy.com/https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"  # ASN æ•°æ®æº URL

# è¿›ç¨‹ç›‘æ§è®¾ç½®
find-process-mode: strict  # ä¸¥æ ¼æ¨¡å¼ï¼Œå°½å¯èƒ½æ‰¾åˆ°æ‰€æœ‰è¿›ç¨‹
global-client-fingerprint: chrome  # è®¾ç½®å…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹ä¸º Chrome

# é…ç½®æ–‡ä»¶å’Œæµé‡å—…æ¢è®¾ç½®
profile:
  store-selected: true  # å­˜å‚¨é€‰æ‹©çš„é…ç½®æ–‡ä»¶
  store-fake-ip: true  # å­˜å‚¨è™šæ‹Ÿ IP åœ°å€

# å—…æ¢è®¾ç½®ï¼Œç”¨äºè¯†åˆ«ç‰¹å®šæµé‡åè®®ï¼ˆå¦‚ HTTPã€TLSã€QUICï¼‰
sniffer:
  enable: true  # å¯ç”¨æµé‡å—…æ¢
  sniff:
    HTTP:
      ports: [80, 8080-8880]  # å—…æ¢ HTTP æµé‡çš„ç«¯å£èŒƒå›´
      override-destination: true  # è¦†ç›–ç›®æ ‡ IP åœ°å€
    TLS:
      ports: [443, 8443]  # å—…æ¢ TLS æµé‡çš„ç«¯å£
    QUIC:
      ports: [443, 8443]  # å—…æ¢ QUIC æµé‡çš„ç«¯å£
  skip-domain:  # ä¸å—…æ¢ä»¥ä¸‹åŸŸåçš„æµé‡
    - "Mijia Cloud"  # è·³è¿‡ç±³å®¶äº‘çš„æµé‡
    - "+.push.apple.com"  # è·³è¿‡ Apple çš„æ¨é€æœåŠ¡åŸŸå

# TUN æ¨¡å¼é…ç½®ï¼Œé€šå¸¸ç”¨äºä»£ç†æµé‡è½¬å‘åˆ°è™šæ‹Ÿç½‘ç»œæ¥å£
tun:
  enable: true  # å¯ç”¨ TUN æ¨¡å¼
  stack: mixed  # ä½¿ç”¨æ··åˆåè®®æ ˆï¼ˆTCP/UDP éƒ½æ”¯æŒï¼‰
  dns-hijack:
    - "any:53"  # åŠ«æŒæ‰€æœ‰ 53 ç«¯å£çš„ DNS è¯·æ±‚
    - "tcp://any:53"  # åŠ«æŒ TCP 53 ç«¯å£çš„ DNS è¯·æ±‚
  auto-route: true  # è‡ªåŠ¨è·¯ç”±æµé‡
  auto-redirect: true  # è‡ªåŠ¨é‡å®šå‘æµé‡
  auto-detect-interface: true  # è‡ªåŠ¨æ£€æµ‹ç½‘ç»œæ¥å£

# DNS é…ç½®éƒ¨åˆ†
dns:
  enable: true  # å¯ç”¨ DNS åŠŸèƒ½
  ipv6: false  # ç¦ç”¨ IPv6 çš„ DNS æŸ¥è¯¢
  respect-rules: true  # å°Šé‡ DNS è§„åˆ™é…ç½®
  enhanced-mode: fake-ip  # ä½¿ç”¨ fake-ip æ¨¡å¼å¢å¼º DNS åŠŸèƒ½
  fake-ip-filter:
    - "*"  # æ‰€æœ‰è¯·æ±‚éƒ½ä½¿ç”¨è™šæ‹Ÿ IP
    - "+.lan"  # å±€åŸŸç½‘åœ°å€ä½¿ç”¨è™šæ‹Ÿ IP
    - "+.local"  # æœ¬åœ°åœ°å€ä½¿ç”¨è™šæ‹Ÿ IP
    - "+.market.xiaomi.com"  # å°ç±³å¸‚åœºåŸŸåä½¿ç”¨è™šæ‹Ÿ IP
  nameserver:
    - https://120.53.53.53/dns-query  # ä½¿ç”¨çš„ DNS æœåŠ¡å™¨ 1ï¼ˆæ”¯æŒ DNS-over-HTTPSï¼‰
    - https://223.5.5.5/dns-query  # ä½¿ç”¨çš„ DNS æœåŠ¡å™¨ 2ï¼ˆæ”¯æŒ DNS-over-HTTPSï¼‰
  proxy-server-nameserver:
    - https://120.53.53.53/dns-query  # ä»£ç†æœåŠ¡å™¨çš„ DNS æœåŠ¡å™¨ 1
    - https://223.5.5.5/dns-query  # ä»£ç†æœåŠ¡å™¨çš„ DNS æœåŠ¡å™¨ 2
  nameserver-policy:
    "rule-set:direct,private":  # å¯¹ä¸­å›½åŸŸåå’Œç§æœ‰åŸŸåä½¿ç”¨æŒ‡å®šçš„ DNS
      - https://120.53.53.53/dns-query
      - https://223.5.5.5/dns-query
    "rule-set:zxgz,ai,telegram":  # å¯¹éä¸­å›½åœ°åŒºçš„åŸŸåä½¿ç”¨å…¶ä»– DNS
      - "https://dns.cloudflare.com/dns-query"  # Cloudflare çš„ DNS æœåŠ¡
      - "https://dns.google/dns-query"  # Google çš„ DNS æœåŠ¡


# è¿‡æ»¤è§„åˆ™
FilterHK: &FilterHK '^(?!.*(ç¾¤|é‚€è¯·|è·³è¿‡|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|com)).*(é¦™æ¸¯|HK|Hong|ğŸ‡­ğŸ‡°).*'
FilterJP: &FilterJP '^(?!.*(ç¾¤|é‚€è¯·|è¿”åˆ©|è·³è¿‡|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|com)).*(æ—¥æœ¬|JP|Japan|ğŸ‡¯ğŸ‡µ).*'
FilterSG: &FilterSG '^(?!.*(ç¾¤|é‚€è¯·|è¿”åˆ©|è·³è¿‡|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|com)).*(æ–°åŠ å¡|SG|Singapore|ğŸ‡¸ğŸ‡¬).*'
FilterUS: &FilterUS '^(?!.*(ç¾¤|é‚€è¯·|è¿”åˆ©|è·³è¿‡|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|com)).*(ç¾å›½|US|United States|America|ğŸ‡ºğŸ‡¸).*'
FilterOthers: &FilterOthers '^(?!.*(ğŸ‡­ğŸ‡°|HK|Hong|é¦™æ¸¯|ğŸ‡¯ğŸ‡µ|JP|Japan|æ—¥æœ¬|ğŸ‡¸ğŸ‡¬|SG|Singapore|æ–°åŠ å¡|ğŸ‡ºğŸ‡¸|US|United States|America|ç¾å›½|ç¾¤|é‚€è¯·|è¿”åˆ©|è·³è¿‡|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|com)).*$'
FilterAll: &FilterAll '^(?=.*(.))(?!.*((?i)ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è·³è¿‡|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|com|(\b(USE|USED|TOTAL|EXPIRE|EMAIL|Panel|Channel|Author)\b|(\d{4}-\d{2}-\d{2}|\d+G)))).*$'


# æ‰‹åŠ¨é€‰æ‹©å‚æ•°
Select: &Select {type: select, url: 'https://cp.cloudflare.com', disable-udp: false, hidden: false, include-all: true}

# ç­–ç•¥ç»„
proxy-groups: 
  - {name: ğŸ¯ èŠ‚ç‚¹é€‰æ‹©, type: select, proxies: [æ‰‹åŠ¨é€‰æ‹©, DIRECT], url: https://cp.cloudflare.com, icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Static.png}
  - {name: æ‰‹åŠ¨é€‰æ‹©, type: select, proxies: [ğŸ‡­ğŸ‡°é¦™æ¸¯,ğŸ‡¸ğŸ‡¬æ–°åŠ å¡,å…¶ä»–èŠ‚ç‚¹], url: https://cp.cloudflare.com, icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Cylink.png}
  - {name: ğŸ‡­ğŸ‡°é¦™æ¸¯, <<: *Select, filter: *FilterHK}
  - {name: ğŸ‡¸ğŸ‡¬æ–°åŠ å¡, <<: *Select, filter: *FilterSG}
  - {name: ğŸ‡¯ğŸ‡µæ—¥æœ¬, <<: *Select, filter: *FilterJP}  
  - {name: ğŸ‡ºğŸ‡¸ç¾å›½, <<: *Select, filter: *FilterUS}
  - {name: ä½å»¶è¿Ÿ, type: select, proxies: [ğŸ‡ºğŸ‡¸ç¾å›½, ğŸ‡¯ğŸ‡µæ—¥æœ¬], icon: https://raw.githubusercontent.com/Orz-3/mini/refs/heads/master/Color/Auto.png}
  - {name: è§†é¢‘ä¸‹è½½, <<: *Select, filter: *FilterAll, icon: https://fastly.jsdelivr.net/gh/Orz-3/mini@master/Color/LineTV.png}  
  - {name: å…¶ä»–èŠ‚ç‚¹, <<: *Select, filter: *FilterOthers, icon: https://fastly.jsdelivr.net/gh/Orz-3/mini@master/Color/Global.png}

# è®¢é˜…è§„åˆ™
rule-providers:
  # ç›´è¿åŸŸååˆ—è¡¨
  direct:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: ./ruleset/direct.yaml
    interval: 86400

  # ç§æœ‰ç½‘ç»œä¸“ç”¨åŸŸååˆ—è¡¨
  private:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  # Apple åœ¨ä¸­å›½å¤§é™†å¯ç›´è¿çš„åŸŸååˆ—è¡¨
  apple:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"
    path: ./ruleset/apple.yaml
    interval: 86400

  # iCloud åŸŸååˆ—è¡¨
  icloud:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"
    path: ./ruleset/icloud.yaml
    interval: 86400

  # AI åŸŸååˆ—è¡¨
  ai:
    type: http
    behavior: classical
    url: "https://testingcf.jsdelivr.net/gh/dler-io/Rules@main/Clash/Provider/AI%20Suite.yaml"
    path: ./ruleset/ai.yaml
    interval: 86400

  # Telegram ä½¿ç”¨çš„ IP åœ°å€åˆ—è¡¨
  telegram:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"
    path: ./ruleset/telegram.yaml
    interval: 86400

  # å±€åŸŸç½‘ IP åŠä¿ç•™ IP åœ°å€åˆ—è¡¨
  lan:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./ruleset/lan.yaml
    interval: 86400

  # ä¸­å›½å¤§é™† IP åœ°å€åˆ—è¡¨
  cncidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  # è‡ªå®šä¹‰è§„åˆ™é›†
  zxgz:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/waxingren/fenliu/refs/heads/main/spxz.yaml"
    path: ./ruleset/zxgz.yaml
    interval: 86400

  # ç›´è¿è½¯ä»¶
  applications:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/waxingren/fenliu/refs/heads/main/appfenliu.yaml"
    path: ./ruleset/applications.yaml
    interval: 86400
  
# åˆ†æµè§„åˆ™
rules:
  ### é IP ç±»è§„åˆ™
  - RULE-SET,zxgz,è§†é¢‘ä¸‹è½½  # è‡ªå®šä¹‰è§„åˆ™é›† zxgzï¼Œç”¨äºè§†é¢‘ä¸‹è½½
  - RULE-SET,ai,ğŸ‡ºğŸ‡¸ç¾å›½
  - RULE-SET,applications,DIRECT  # ç›´è¿è½¯ä»¶
  - RULE-SET,direct,DIRECT  # ç›´è¿åŸŸååˆ—è¡¨
  - RULE-SET,private,DIRECT  # ç§æœ‰ç½‘ç»œä¸“ç”¨åŸŸååˆ—è¡¨
  - RULE-SET,apple,DIRECT  # Apple åœ¨ä¸­å›½å¤§é™†å¯ç›´è¿çš„åŸŸååˆ—è¡¨
  - RULE-SET,icloud,DIRECT  # iCloud åŸŸååˆ—è¡¨
  # ai åŸŸååˆ—è¡¨
  ### IP ç±»è§„åˆ™
  - RULE-SET,telegram,ä½å»¶è¿Ÿ  # Telegram ä½¿ç”¨çš„ IP åœ°å€åˆ—è¡¨
  - RULE-SET,cncidr,DIRECT,no-resolve  # ä¸­å›½å¤§é™† IP åœ°å€åˆ—è¡¨
  - RULE-SET,lan,DIRECT,no-resolve  # å±€åŸŸç½‘ IP åŠä¿ç•™ IP åœ°å€åˆ—è¡¨
  - GEOIP,lan,DIRECT,no-resolve  # å±€åŸŸç½‘ IP
  - GEOIP,CN,DIRECT  # ä¸­å›½å¤§é™† IP

  ### é»˜è®¤åŒ¹é…ç­–ç•¥
  - MATCH,ğŸ¯ èŠ‚ç‚¹é€‰æ‹©  
